# frozen_string_literal: true

div class: :panel do
  div class: :identite do
    div strong evaluation_globale.utilisateur
    div l evaluation_globale.date, format: :evaluation
  end

  h2 class: 'text-center' do
    span class: 'btn btn-info btn-lg' do
      t('.efficience_globale', efficience: formate_efficience(evaluation_globale.efficience))
    end
  end

  div class: :row do
    evaluation_globale.evaluations.each do |evaluation|
      situation = evaluation.situation
      div class: "#{rapport_colonne_class} #{situation}" do
        div t('.situation', situation: t(".#{situation}"))
        div class: :progress do
          efficience = evaluation.efficience
          div class: 'progress-bar', role: 'progressbar', style: "width: #{efficience}%",
              'aria-valuemin': 0, 'aria-valuemax': 100, 'aria-valuenow': efficience do
            formate_efficience(efficience).to_s
          end
        end
      end
    end
  end
end

evaluation_globale.evaluations.each do |evaluation|
  panel t('.situation', situation: t(".#{evaluation.situation}")) do
    render evaluation.situation, evaluation: evaluation
    render 'evaluation_competences', evaluation: evaluation
  end
end
