# frozen_string_literal: true

panel t('.restitution_securite') do
  attributes_table_for [
    [t('admin.restitutions.restitution_colonnes.valeur_utilisateur'), restitution],
    [t('admin.restitutions.restitution_colonnes.moyenne_glissante'), moyenne_glissante],
    [t('admin.restitutions.restitution_colonnes.ecart_type_glissant'), ecart_type_glissant],
    [t('admin.restitutions.restitution_colonnes.cote_z'), cote_z]
  ] do
    row do |(titre, _)|
      strong titre
    end
    row t('.temps_entrainement') do |(_, r)|
      formate_duree r.temps_entrainement
    end
    row t('.dangers_bien_identifies') do |(_, r)|
      r.nombre_dangers_bien_identifies
    end
    row t('.dangers_mal_identifies') do |(_, r)|
      r.nombre_dangers_mal_identifies
    end
    row t('.dangers_bien_identifies_avant_aide_1') do |(_, r)|
      r.nombre_dangers_bien_identifies_avant_aide_1
    end
    row t('.dangers_bien_qualifies') do |(_, r)|
      r.nombre_bien_qualifies
    end
    row t('.retours_dangers_deja_qualifies') do |(_, r)|
      r.nombre_retours_deja_qualifies
    end
    row t('.delai_ouvertures_zones_dangers') do |_, r|
      formate_durees r.delai_ouvertures_zones_dangers
    end
    row t('.delai_moyen_ouvertures_zones_dangers') do |_, r|
      formate_duree r.delai_moyen_ouvertures_zones_dangers
    end
    row t('.attention_visuo_spatiale') do |_, r|
      if r.attention_visuo_spatiale.present?
        t(r.attention_visuo_spatiale, scope: 'admin.evaluations.restitution_competence')
      end
    end
    row t('.retours_zones_sans_danger') do |(_, r)|
      r.nombre_reouverture_zone_sans_danger
    end
    row t('.temps_bonnes_qualifications_dangers') do |(_, r)|
      ul do
        r.temps_bonnes_qualifications_dangers&.each do |danger, temps|
          li "#{danger} : #{formate_duree(temps)}"
        end
      end
    end
    row t('.temps_recherche_zones_dangers') do |(_, r)|
      ul do
        r.temps_recherche_zones_dangers&.each do |danger, temps|
          li "#{danger} : #{formate_duree(temps)}"
        end
      end
    end
    row t('.temps_total_ouverture_zones_dangers') do |(_, r)|
      ul do
        r.temps_total_ouverture_zones_dangers&.each do |danger, temps|
          li "#{danger} : #{formate_duree(temps)}"
        end
      end
    end
  end
end
